<form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
  <app-text-field
    formControlName="emailorphone"
    label="پست الکترونیک یا تلفن همراه"
    placeholder="مثلا test@email.com یا 0912..."
    [isStatic]="false"
    backgroundColor="#f9fafb"
    [type]="inputType() === 'phonenumber' ? 'tel' : 'email'"
    [showValidationUI]="true"
    [unmetRules]="inputErrors()"
    [success]="
      inputErrors().length === 0 &&
      (loginForm.get('emailorphone')?.dirty ?? false) &&
      loginForm.get('emailorphone')?.value
    "
  >
  </app-text-field>

  <app-text-field
    formControlName="password"
    label="رمز عبور"
    placeholder="رمز عبور خود را وارد کنید"
    [isStatic]="false"
    backgroundColor="#f9fafb"
    type="password"
    [showValidationUI]="false"
  >
  </app-text-field>

  @if (shouldShowCaptcha()) {
  <div class="animate-fade-in-up p-4 bg-red-50 border border-red-100 rounded-xl">
    <p class="text-xs text-red-600 mb-3 font-bold text-center">
      به دلیل تلاش‌های ناموفق متعدد، لطفا کد امنیتی را وارد کنید.
    </p>

    <div class="flex gap-3 justify-between items-end">
      <div class="w-2/3">
        <app-text-field
          formControlName="captcha"
          label="کد امنیتی"
          backgroundColor="#f9fafb"
          placeholder="کد امنیتی"
          type="text"
          [showValidationUI]="true"
          [success]="captchaInput() === 8372"
        >
        </app-text-field>
      </div>

      <div
        class="w-1/3 h-[48px] bg-gray-100 rounded-lg border border-gray-200 flex items-center justify-center relative overflow-hidden select-none"
      >
        <div
          class="absolute inset-0 opacity-20 pointer-events-none"
          style="
            background-image: repeating-linear-gradient(
              45deg,
              transparent,
              transparent 5px,
              #000 5px,
              #000 6px
            );
          "
        ></div>
        <span
          class="font-mono text-xl font-bold tracking-widest text-gray-600 rotate-3 inline-block"
          >8372</span
        >
      </div>
    </div>
  </div>
  }

  <div class="flex justify-start">
    <button
      type="button"
      (click)="ForgotPassClick.emit()"
      class="text-sm text-blue-600 hover:text-blue-800 hover:underline transition-colors cursor-pointer"
    >
      رمز عبور را فراموش کرده‌اید؟
    </button>
  </div>

  <button
    type="submit"
    [disabled]="!loginForm.valid"
    class="w-full py-3 px-4 mt-2 bg-blue-600 text-white rounded-xl font-bold hover:bg-blue-700 transition-all duration-200 disabled:bg-gray-300 disabled:cursor-not-allowed shadow-md hover:shadow-lg active:scale-95"
  >
    ورود به سیستم
  </button>
</form>
